# MFA with TOTP

The time-based One Time Password(TOTP) is a temporary passcode, generated by an algorithm, which can be used only once. The algorithm that generates each password uses the current time of day as one of its factors, ensuring that each password is unique.
TOTP is considered more secure because the passcode is valid only for a short window of time. TOTP generated by Asgardeo is valid for **30** seconds.

TOTP authenticator uses the [TOTP specification](https://datatracker.ietf.org/doc/html/rfc6238) to calculate the access tokens based on the time and the shared secret key between the user and the identity provider.

To use TOTP as a multi-factor authentication(MFA) option, users need to have an authenticator app that can scan the QR code and generate a one-time password. Some authenticator apps are:
- [Google Authenticator](https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2)
- [Authy](https://play.google.com/store/apps/details?id=com.authy.authy)

## Prerequisites
1. To get started, you need to have an application registered in Asgardeo.
If you don't already have one, see the instructions on <a href="/guides/applications/">registering an application</a>.
2. Download and install one of the authenticator apps mentioned above.

::: tip Note
 - You can use TOTP for multi-factor authentication only if a previous authentication step is configured with **username and password** or an <a href="/guides/identity-providers/">identity provider</a>.   
 - TOTP cannot be used as a first step of your login flow.
:::


## Enable TOTP for an app
To enable TOTP multi-factor authentication, you need to add **TOTP** in the authentication flow of an application. Below steps will guide you on how to enable TOTP for an application:
1. In the Asgardeo Console, there are two ways to start enabling TOTP for an application. 
 - Option1: Navigate to **Develop > Applications**.
 - Option2: Navigate to **Connections > TOTP** and click **connect**.
2. Follow either one of the above options.
3. Select the application to add the TOTP.
4. Go to the **Sign-in Method** tab of the selected application.
5. Click **Add TOTP as a second factor**. This will add TOTP as a second factor authenticator.
    <img :src="$withBase('/assets/img/guides/mfa/totp/add-totp-authenticator.png')" alt="Configuring TOTP authenticator in Asgardeo">
6. Click **Update**.

## Enroll TOTP during first login 
You can enroll for TOTP notification from the first login to the business application using some authenticator apps. Follow below steps to know how to access the authenticator app from your mobile and enroll to TOTP.
1. Download authenticator.
2. Login to your application.
3. User is prompted with QR code , scan the code and click continue. (This step will happen only for the first time for a user after enabling TOTP by the administrator)
    <img :src="$withBase('/assets/img/guides/mfa/totp/scan-qr-code-totp.png')" alt="QR code for TOTP authenticator in Asgardeo">
4. Check your authenticator which you used to scan the code.
    <img :src="$withBase('/assets/img/guides/mfa/totp/google-authenticator.png')" alt="OTP token from the authenticator">
5. Enter the otp by checking the authenticator app.
    <img :src="$withBase('/assets/img/guides/mfa/totp/enter-otp-token.png')" alt="User enters OTP token in Asgardeo">
6. Click **Continue**.


## Enroll TOTP via MyAccount
After the first time login, user will not be prompted with QR code in the login flow. In case, if the user wants to use another authenticator app for getting otp, user can configure it via Asgardeo MyAccount. The QR code via MyAccount is same the code prompted in the first time login flow.

Note that, enrolling TOTP via MyAccount can be done only after first login attempt using totp authentication, and it is available only for <a href="/guides/user-management/manage-users/user-accounts/customer/">customer</a> user accounts.
 
1. In the Asgardeo MyAccount, navigate to **Security > Multi-Factor Authentication**.
    <img :src="$withBase('/assets/img/guides/mfa/totp/scan-qr-code-via-myaccount.png')" alt="SCAN QR code in Asgardeo MyAccount">
2. Click TOTP edit icon and scan the prompted QR code using an authenticator.
